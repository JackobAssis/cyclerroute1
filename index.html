<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CyclerRoute - PWA para ciclistas criar, visualizar e compartilhar rotas">
    <meta name="theme-color" content="#32FF7E">
    
    <title>CyclerRoute</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/styles.css">
    
    <!-- Leaflet CSS (mapa) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css">
    <!-- Leaflet Routing Machine CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.css">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="assets/icons/icon.svg">
    <link rel="apple-touch-icon" href="assets/icons/icon.svg">
    
    <!-- Dark mode meta -->
    <meta name="color-scheme" content="dark">
</head>
<body>
    <!-- Main Content -->
    <main id="app">
        <!-- Home Screen -->
        <div id="screen-home" class="screen active">
            <div id="map-home" class="map-container"></div>
            
            <div class="floating-controls home-controls">
                <button id="btn-create-route" class="btn btn-primary btn-floating">
                    ‚ûï Criar Rota
                </button>
                <button id="btn-my-routes" class="btn btn-secondary btn-floating">
                    üìã Minhas Rotas
                </button>
            </div>
        </div>

        <!-- Create Route Screen -->
        <div id="screen-create" class="screen">
            <div id="map-create" class="map-container"></div>
            
            <div class="route-create-bar">
                <button id="btn-back-create" class="btn btn-icon btn-back">‚Üê Voltar</button>
                <div class="route-info-panel">
                    <div class="info-item">
                        <span class="info-label">Pontos:</span>
                        <span id="points-count" class="info-value">0</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Dist√¢ncia:</span>
                        <span id="distance-display" class="info-value">0 km</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Tempo:</span>
                        <span id="duration-display" class="info-value">0 min</span>
                    </div>
                </div>
                <div class="action-buttons">
                    <button id="btn-clear-route" class="btn btn-danger btn-action">üóëÔ∏è Limpar</button>
                    <button id="btn-save-route" class="btn btn-success btn-action" disabled>üíæ Salvar</button>
                </div>
            </div>
        </div>

        <!-- Save Route Dialog -->
        <div id="dialog-save-route" class="modal" style="display: none;">
            <div class="modal-overlay"></div>
            <div class="modal-content">
                <h3>Salvar Rota</h3>
                <input type="text" id="input-route-name" class="input" placeholder="Nome da rota..." required>
                <textarea id="input-route-description" class="textarea" placeholder="Descri√ß√£o (opcional)" rows="3"></textarea>
                <div class="modal-buttons">
                    <button id="btn-cancel-save" class="btn btn-secondary">Cancelar</button>
                    <button id="btn-confirm-save" class="btn btn-primary">Salvar</button>
                </div>
            </div>
        </div>

        <!-- My Routes Screen -->
        <div id="screen-routes-list" class="screen">
            <div class="screen-header">
                <button id="btn-back-list" class="btn btn-icon btn-back">‚Üê Voltar</button>
                <h2>Minhas Rotas</h2>
                <div style="width: 40px;"></div>
            </div>
            
            <div id="routes-list-container" class="routes-list"></div>
            
            <div id="empty-routes" class="empty-state">
                <p>Nenhuma rota salva</p>
                <button id="btn-create-first-route" class="btn btn-primary">Criar Primeira Rota</button>
            </div>
        </div>

        <!-- View Route Screen -->
        <div id="screen-view-route" class="screen">
            <div id="map-view" class="map-container"></div>
            
            <div class="floating-controls">
                <button id="btn-back-view" class="btn btn-icon btn-back">‚Üê Voltar</button>
                
                <div class="route-info-panel">
                    <h3 id="view-route-name" class="route-name"></h3>
                    <p id="view-route-description" class="route-description"></p>
                    <div class="info-item">
                        <span class="info-label">Dist√¢ncia:</span>
                        <span id="view-distance" class="info-value">0 km</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Tempo estimado:</span>
                        <span id="view-duration" class="info-value">0 min</span>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button id="btn-navigate-route" class="btn btn-primary btn-action">üß≠ Percorrer Rota</button>
                </div>
            </div>
        </div>

        <!-- Navigate Route Screen -->
        <div id="screen-navigate" class="screen">
            <div id="map-navigate" class="map-container"></div>
            
            <div class="floating-controls">
                <button id="btn-stop-navigation" class="btn btn-danger btn-back">‚èπ Parar</button>
                
                <div class="navigation-panel">
                    <div class="navigation-status">
                        <span id="nav-status" class="status-text">Aguardando GPS...</span>
                    </div>
                    <div class="navigation-stats">
                        <div class="stat-item">
                            <span class="stat-label">Dist√¢ncia restante:</span>
                            <span id="nav-distance-remaining" class="stat-value">-- km</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Velocidade:</span>
                            <span id="nav-speed" class="stat-value">0 km/h</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Tempo decorrido:</span>
                            <span id="nav-time-elapsed" class="stat-value">00:00</span>
                        </div>
                    </div>
                    <div id="nav-warning" class="navigation-warning" style="display: none;">
                        ‚ö†Ô∏è Voc√™ est√° fora da rota!
                    </div>
                </div>
            </div>
        </div>

        <!-- Complete Navigation Dialog -->
        <div id="dialog-navigation-complete" class="modal" style="display: none;">
            <div class="modal-overlay"></div>
            <div class="modal-content">
                <h3>üéâ Rota Conclu√≠da!</h3>
                <div class="summary-stats">
                    <div class="summary-item">
                        <span class="summary-label">Tempo total:</span>
                        <span id="summary-time" class="summary-value">--</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Dist√¢ncia percorrida:</span>
                        <span id="summary-distance" class="summary-value">--</span>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button id="btn-close-summary" class="btn btn-primary">OK</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.min.js"></script>
    
    <!-- Splash Screen (mostra durante load) -->
    <script type="module" src="src/splash-screen.js"></script>
    
    <!-- App Principal -->
    <script type="module" src="src/app.js"></script>

    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(reg => console.log('‚úì Service Worker registrado', reg))
                .catch(err => console.warn('Service Worker registration failed:', err));
        }
    </script>
</body>
</html>
